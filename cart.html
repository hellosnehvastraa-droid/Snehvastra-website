<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="theme-color" content="#2C1B4A"/>
  <title>Cart â€” Snehvastra</title>
  <meta name="description" content="Snehvastra live inventory, NFC verified cart, auction integration, collector bundles, secure checkout."/>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@400;500;600;700;900&family=Poppins:wght@200;300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet"/>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    :root{
      /* ðŸ”’ SNEHVASTRA GENTLE LUXURY SYSTEM (LOCKED) */
      --amethyst:#2C1B4A; --amethyst-light:#4A377A; --amethyst-glow:#6B5ACF;
      --pearl:#F8F6F9; --ivory:#EDE8F5; --silk:#D9D2E9;
      --rose-gold:#E8B4B8; --rose-gold-dark:#D4A5AF; --sage:#A8B5A2;
      --success:#10B981; --shadow-soft:0 35px 140px rgba(44,27,74,0.15); --shadow-glow:0 0 35px rgba(107,90,207,0.2);
      --radius:32px; --max-width:1600px; --ease:cubic-bezier(0.32,0.72,0,1);
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#F8F6F9 0%,#EDE8F5 50%,#D9D2E9 100%);color:var(--amethyst);overflow-x:hidden;line-height:1.8;position:relative;}

    /* ðŸ”’ FIXED ETHEREAL HEADER (FULL SYSTEM) */
    header{position:fixed;top:0;left:0;right:0;z-index:1000;background:linear-gradient(180deg,rgba(248,246,249,0.98),rgba(237,232,245,0.95));backdrop-filter:blur(40px);border-bottom:1px solid rgba(44,27,74,0.08);padding:20px 0;will-change:transform;}
    .header-container{max-width:var(--max-width);margin:0 auto;padding:0 5%;display:flex;align-items:center;justify-content:space-between;}
    .brand{display:flex;gap:20px;align-items:center;cursor:pointer;transition:all 0.6s var(--ease);}
    .brand:hover{transform:translateY(-4px);}
    .logo{height:60px;border-radius:20px;box-shadow:0 20px 60px rgba(44,27,74,0.12);transition:inherit;}
    nav ul{display:flex;gap:12px;list-style:none;margin:0;padding:0;flex-wrap:wrap;}
    nav a{padding:16px 28px;border-radius:24px;font-weight:400;color:var(--amethyst);text-decoration:none;font-size:0.95rem;backdrop-filter:blur(20px);transition:all 0.4s var(--ease);position:relative;white-space:nowrap;min-height:64px;display:flex;align-items:center;}
    nav a::after{content:'';position:absolute;bottom:4px;left:50%;width:0;height:2px;background:var(--rose-gold);transition:all 0.4s var(--ease);transform:translateX(-50%);}
    nav a:hover::after{width:80%;}
    nav a.active{color:var(--amethyst);font-weight:500;background:rgba(232,180,184,0.15);box-shadow:0 8px 32px rgba(232,180,184,0.15);}

    /* âœ… HAMBURGER + 64px TOUCH */
    .hamburger{display:none;background:none;border:none;font-size:2rem;color:var(--amethyst);cursor:pointer;padding:16px;min-height:64px;}
    @media(max-width:768px){
      .hamburger{display:block!important;}
      header.menu-open nav{display:block!important;position:absolute;top:100%;left:0;right:0;background:var(--pearl);backdrop-filter:blur(40px);border-top:1px solid rgba(44,27,74,0.08);padding:20px 0;}
      header.menu-open nav ul{flex-direction:column;width:100%;gap:8px;}
      nav a{display:block;text-align:center;padding:20px;width:100%;border-radius:16px;min-height:64px;}
    }

    /* âœ… AUCTION BANNER (LIVE) */
    .auction-banner{position:fixed;top:140px;right:30px;z-index:900;max-width:280px;background:linear-gradient(135deg,var(--rose-gold),var(--rose-gold-dark));color:var(--amethyst);padding:24px 32px;border-radius:28px;font-family:'Clash Display',serif;font-weight:700;font-size:1.2rem;text-align:center;box-shadow:var(--shadow-soft);border:1px solid rgba(44,27,74,0.08);}
    @media(max-width:768px){.auction-banner{top:120px;right:20px;max-width:240px;font-size:1rem;padding:20px 24px;}}
    .auction-timer{font-size:1.6rem;font-weight:900;color:var(--amethyst);display:block;margin-top:8px;}

    /* ðŸ›’ CART HERO (FULL CONTENT) */
    .hero{position:relative;max-width:var(--max-width);margin:140px auto 80px;padding:0 5%;text-align:center;background:var(--pearl);backdrop-filter:blur(50px);border-radius:var(--radius);padding:100px;box-shadow:var(--shadow-soft);border:1px solid rgba(44,27,74,0.08);}
    @media(max-width:768px){.hero{padding-top:120px;margin:120px auto 60px;padding:80px 40px;}}
    .hero-title{font-family:'Clash Display',serif;font-size:clamp(4rem,10vw,6.5rem);background:linear-gradient(135deg,var(--amethyst),var(--amethyst-glow));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0 0 28px;font-weight:900;letter-spacing:-1px;}
    .hero-subtitle{font-size:clamp(1.2rem,2.5vw,1.5rem);color:var(--amethyst);opacity:0.8;max-width:700px;margin:0 auto 64px;line-height:1.8;}
    .cart-stats{display:flex;justify-content:center;gap:48px;margin-top:48px;flex-wrap:wrap;}
    @media(max-width:768px){.cart-stats{gap:32px;flex-direction:column;align-items:center;}}
    .stat{background:var(--pearl);backdrop-filter:blur(40px);padding:36px 48px;border-radius:28px;border:1px solid rgba(44,27,74,0.06);min-width:180px;text-align:center;transition:all 0.6s var(--ease);box-shadow:var(--shadow-soft);}
    .stat:hover{transform:translateY(-8px) scale(1.02);}
    .stat-value{font-family:'Clash Display',serif;font-size:clamp(2.2rem,5vw,3rem);font-weight:900;color:var(--amethyst);display:block;margin-bottom:12px;letter-spacing:-0.5px;}
    .stat-label{font-size:1.1rem;font-weight:400;opacity:0.8;text-transform:uppercase;letter-spacing:0.2px;}

    /* ðŸ›’ CART GRID (PERFECT LAYOUT) */
    .cart-grid{max-width:var(--max-width);margin:0 auto 140px;padding:0 5%;display:grid;grid-template-columns:1fr 440px;gap:100px;align-items:start;}
    @media(max-width:1400px){.cart-grid{grid-template-columns:1fr;gap:80px;}}
    @media(max-width:768px){.cart-grid{gap:60px;}}

    /* ðŸ“¦ CART ITEMS (FULL FUNCTIONALITY) */
    .cart-items{background:var(--pearl);backdrop-filter:blur(50px);border-radius:var(--radius);padding:80px;box-shadow:var(--shadow-soft);border:1px solid rgba(44,27,74,0.08);}
    @media(max-width:768px){.cart-items{padding:60px 40px;}}
    .cart-title{font-family:'Clash Display',serif;font-size:clamp(2.2rem,6vw,3.2rem);color:var(--amethyst);margin:0 0 56px;text-align:center;font-weight:900;letter-spacing:-0.5px;}
    .cart-header{display:grid;grid-template-columns:80px 1fr auto auto 120px;gap:28px;align-items:center;padding:28px 0;font-size:1.15rem;font-weight:600;color:var(--amethyst);opacity:0.7;border-bottom:2px solid rgba(44,27,74,0.08);margin-bottom:40px;}
    .cart-item{display:grid;grid-template-columns:80px 1fr auto auto 120px;gap:28px;align-items:center;padding:40px 0;border-bottom:1px solid rgba(44,27,74,0.04);transition:all 0.4s var(--ease);}
    .cart-item:last-child{border-bottom:none;}
    .cart-item:hover{background:rgba(232,180,184,0.04);}
    @media(max-width:768px){.cart-header,.cart-item{grid-template-columns:80px 1fr 120px;gap:20px;}.cart-price{display:none;}}

    .cart-img{width:72px;height:72px;border-radius:20px;overflow:hidden;box-shadow:0 16px 48px rgba(44,27,74,0.12);transition:all 0.4s var(--ease);}
    .cart-img:hover{transform:scale(1.05);}
    .cart-img img{width:100%;height:100%;object-fit:cover;}
    
    .cart-info h4{font-family:'Clash Display',serif;font-size:1.5rem;color:var(--amethyst);margin:0 0 12px;font-weight:900;line-height:1.2;}
    .cart-meta{font-size:1.05rem;color:var(--amethyst);opacity:0.65;line-height:1.6;}
    .cart-nfc-badge{background:var(--success);color:#fff;padding:6px 16px;border-radius:24px;font-size:0.9rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;}
    
    .cart-qty{display:flex;align-items:center;gap:16px;background:var(--pearl);backdrop-filter:blur(30px);padding:16px 24px;border-radius:28px;border:1px solid rgba(44,27,74,0.1);}
    .qty-btn{width:44px;height:44px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--amethyst),var(--amethyst-light));color:var(--pearl);font-weight:900;font-size:1.3rem;cursor:pointer;transition:all 0.3s var(--ease);}
    .qty-btn:hover{transform:scale(1.08) rotate(5deg);}
    .qty-value{font-weight:700;font-size:1.2rem;color:var(--amethyst);min-width:36px;text-align:center;}
    
    .cart-price{font-family:'Clash Display',serif;font-size:1.5rem;font-weight:900;color:var(--amethyst);}
    .cart-total{font-family:'Clash Display',serif;font-size:1.7rem;font-weight:900;background:linear-gradient(135deg,var(--amethyst),var(--amethyst-glow));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    
    .cart-remove{width:40px;height:40px;border-radius:50%;border:none;background:rgba(44,27,74,0.1);color:var(--amethyst);font-size:1.3rem;font-weight:900;cursor:pointer;transition:all 0.3s var(--ease);display:flex;align-items:center;justify-content:center;}
    .cart-remove:hover{background:var(--rose-gold);color:var(--amethyst);transform:scale(1.1) rotate(90deg);}

    /* ðŸ’Ž SUMMARY (STICKY PERFECTION) */
    .cart-summary{position:sticky;top:160px;background:var(--pearl);backdrop-filter:blur(60px);border-radius:var(--radius);padding:80px;box-shadow:var(--shadow-soft);border:1px solid rgba(44,27,74,0.1);align-self:start;}
    @media(max-width:768px){.cart-summary{padding:64px 48px;top:140px;}}
    .summary-title{font-family:'Clash Display',serif;font-size:clamp(2rem,5vw,2.8rem);color:var(--amethyst);margin:0 0 56px;text-align:center;font-weight:900;letter-spacing:-0.3px;}
    .summary-item{display:flex;justify-content:space-between;padding:32px 0;font-size:1.25rem;border-bottom:1px solid rgba(44,27,74,0.08);transition:all 0.3s var(--ease);}
    .summary-item:last-child{border-bottom:none;}
    .summary-item:hover{background:rgba(232,180,184,0.04);}
    .summary-label{font-weight:600;color:var(--amethyst);opacity:0.8;}
    .summary-value{font-family:'Clash Display',serif;font-size:1.6rem;font-weight:900;color:var(--amethyst);}
    .summary-total{background:linear-gradient(135deg,rgba(107,90,207,0.04),rgba(232,180,184,0.04));padding:48px;border-radius:28px;margin-top:40px;border:2px solid rgba(44,27,74,0.12);}
    .total-label{font-family:'Clash Display',serif;font-size:1.5rem;font-weight:700;color:var(--amethyst);opacity:0.7;margin-bottom:20px;text-transform:uppercase;letter-spacing:0.3px;}
    .total-amount{font-family:'Clash Display',serif;font-size:clamp(3rem,8vw,4.5rem);font-weight:900;background:linear-gradient(135deg,var(--amethyst),var(--amethyst-glow));-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1;}
    
    .checkout-btn{width:100%;padding:36px;border:none;border-radius:32px;background:linear-gradient(135deg,var(--amethyst),var(--amethyst-light));color:var(--pearl);font-family:'Clash Display',serif;font-size:1.7rem;font-weight:900;cursor:pointer;box-shadow:var(--shadow-soft);transition:all 0.6s var(--ease);height:100px;margin-top:32px;text-transform:uppercase;letter-spacing:0.5px;}
    .checkout-btn:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 45px 140px rgba(44,27,74,0.25);}
    .checkout-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;background:var(--amethyst);}
    
    .continue-btn{width:100%;padding:24px;border-radius:28px;border:2px solid rgba(44,27,74,0.2);background:var(--pearl);font-family:'Clash Display',serif;font-weight:700;font-size:1.2rem;color:var(--amethyst);cursor:pointer;transition:all 0.4s var(--ease);margin-top:20px;}
    .continue-btn:hover{background:rgba(44,27,74,0.05);transform:translateY(-2px);}

    /* âˆ… EMPTY STATE */
    .empty-cart{text-align:center;padding:140px 60px;color:var(--amethyst);opacity:0.6;}
    @media(max-width:768px){.empty-cart{padding:100px 40px;}}
    .empty-title{font-family:'Clash Display',serif;font-size:clamp(3rem,8vw,4.5rem);color:var(--amethyst);margin:0 0 32px;font-weight:900;letter-spacing:-1px;}
    .empty-subtitle{font-size:1.4rem;margin:0 0 64px;line-height:1.8;opacity:0.8;}

    /* PERFECT FOOTER */
    footer{padding:140px 5% 80px;text-align:center;background:var(--pearl);color:var(--amethyst);border-top:1px solid rgba(44,27,74,0.06);font-size:1rem;font-weight:300;}
    @media(max-width:768px){footer{padding:100px 5% 60px;}}

    /* TOAST SYSTEM */
    #toast{position:fixed;bottom:60px;left:50%;transform:translateX(-50%) translateY(100px);background:linear-gradient(135deg,var(--rose-gold),var(--rose-gold-dark));color:var(--amethyst);padding:24px 48px;border-radius:28px;font-family:'Clash Display',serif;font-weight:800;font-size:1.1rem;z-index:10000;transition:all 0.6s var(--ease);max-width:92vw;box-shadow:var(--shadow-soft);backdrop-filter:blur(30px);}
    #toast.show{transform:translateX(-50%) translateY(0);}
  </style>
</head>
<body>
  <!-- ðŸ”’ PERFECT HEADER SYSTEM -->
  <header>
    <div class="header-container">
      <div class="brand" onclick="location.href='index.html'">
        <img src="images/logo.final.png" class="logo" alt="Snehvastra"/>
        <div style="font-family:'Clash Display',serif;font-size:1.5rem;font-weight:600;color:var(--amethyst);">Snehvastra</div>
      </div>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="collection.html">Collection</a></li>
          <li><a href="blog.html">Stories</a></li>
          <li><a href="auction.html">Auction</a></li>
          <li><a href="cart.html" class="active">Cart (<span id="cartCount">0</span>)</a></li>
          <li id="authArea"></li>
        </ul>
      </nav>
      <button class="hamburger" id="hamburger">â˜°</button>
    </div>
  </header>

  <!-- âœ… AUCTION COUNTDOWN -->
  <div class="auction-banner" id="auctionBanner">
    ðŸ”¥ SNEHVASTRA ONE AUCTION<br>
    <span class="auction-timer" id="auctionTimer">Loading...</span>
  </div>

  <!-- ðŸ›’ HERO (CORRECTED) -->
  <section class="hero" data-aos="fade-in">
    <h1 class="hero-title" data-aos="fade-up" data-aos-delay="200">Your Collection</h1>
    <p class="hero-subtitle" data-aos="fade-up" data-aos-delay="400">Snehvastra live inventory â€¢ NFC verified pieces â€¢ Collector pricing</p>
    <div class="cart-stats">
      <div class="stat" data-aos="fade-up" data-aos-delay="100">
        <div style="font-size:clamp(2rem,4vw,2.8rem);font-weight:900;color:var(--amethyst);" id="heroItems">0</div>
        <div>Items</div>
      </div>
      <div class="stat" data-aos="fade-up" data-aos-delay="200">
        <div style="font-size:clamp(2rem,4vw,2.8rem);font-weight:900;color:var(--amethyst);" id="heroTotal">â‚¹0</div>
        <div>Total</div>
      </div>
      <div class="stat" data-aos="fade-up" data-aos-delay="300">
        <div style="font-size:clamp(2rem,4vw,2.8rem);font-weight:900;color:var(--success);">âœ“</div>
        <div>NFC Ready</div>
      </div>
    </div>
  </section>

  <div class="cart-grid">
    <!-- ðŸ“¦ CART ITEMS (100% FUNCTIONALITY) -->
    <section class="cart-items" data-aos="fade-right">
      <h2 class="cart-title" data-aos="fade-up">Selected Pieces</h2>
      
      <div class="cart-header" data-aos="fade-up" data-aos-delay="100">
        <span></span>
        <span>Piece Details</span>
        <span>Unit</span>
        <span>Price</span>
        <span>Total</span>
      </div>
      
      <div id="cartItems"></div>
      
      <div id="emptyCart" class="empty-cart" style="display:none;">
        <h2 class="empty-title" data-aos="zoom-in">Empty Cart</h2>
        <p class="empty-subtitle" data-aos="fade-up" data-aos-delay="200">Your collection is waiting. Discover Snehvastra's latest drops.</p>
        <a href="collection.html" class="continue-btn" style="max-width:360px;display:inline-block;" data-aos="fade-up" data-aos-delay="400">Explore Collection</a>
      </div>
    </section>

    <!-- ðŸ’Ž SUMMARY (STICKY + CORRECTED) -->
    <aside class="cart-summary" data-aos="fade-left">
      <h2 class="summary-title">Collector Summary</h2>
      
      <div class="summary-item">
        <span class="summary-label">Subtotal</span>
        <span class="summary-value" id="subtotal">â‚¹0</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">Snehvastra Shipping</span>
        <span class="summary-value" id="shipping">â‚¹0</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">GST (18%)</span>
        <span class="summary-value" id="tax">â‚¹0</span>
      </div>
      
      <div class="summary-total">
        <div class="total-label">Grand Total</div>
        <div class="total-amount" id="grandTotal">â‚¹0</div>
      </div>
      
      <div style="font-size:1.05rem;color:var(--amethyst);opacity:0.7;margin-top:40px;line-height:1.6;text-align:center;">
        Free shipping above â‚¹50,000 â€¢ NFC tags included â€¢ Kota direct
      </div>
      
      <button class="checkout-btn" id="checkoutBtn" disabled>â†’ Secure Checkout</button>
      <button class="continue-btn" onclick="location.href='collection.html'">Continue Shopping</button>
    </aside>
  </div>

  <footer>
    Â© <span id="year"></span> Snehvastra. Snehvastra Studio â€¢ NFC Authenticated â€¢ Collector Grade.
  </footer>

  <div id="toast"></div>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    // ðŸ”’ FULL SYSTEM (NO CHANGES - ENHANCED)
    const USER_KEY = "snehvastra_user"; 
    const CART_KEY = "snehvastra_cart";
    let cart = JSON.parse(localStorage.getItem(CART_KEY) || "{}");
    let user = JSON.parse(localStorage.getItem(USER_KEY) || 'null');

    // âœ… FULL PRODUCT DB (UNCHANGED)
    const PRODUCT_DB = {
      "signature-tee": {name:"Signature Tee Black",price:4999,image:"images/products/tee.jpg",nfc:true,stock:12},
      "cloud-hoodie": {name:"Cloud Hoodie Indigo",price:19999,image:"images/products/hoodie.jpg",nfc:true,stock:8},
      "midnight-jacket": {name:"Midnight Jacket",price:29999,image:"images/products/jacket.jpg",nfc:true,stock:5},
      "snehvastra-one": {name:"Snehvastra ONE 1/1",price:125000,image:"images/products/one.jpg",nfc:true,stock:1,auction:true}
    };

    function renderAuth(){
      const authArea = document.getElementById("authArea");
      if(user && user.loggedIn){
        authArea.innerHTML = `<span style="color:var(--rose-gold);font-weight:600;font-family:'Clash Display',serif;">${user.name}</span>`;
      } else {
        authArea.innerHTML = `<a href="user-login.html" style="padding:12px 28px;border:1px solid var(--rose-gold);color:var(--rose-gold);border-radius:24px;font-weight:500;text-decoration:none;">Login</a>`;
      }
    }

    function updateCartCount(){
      const total = Object.values(cart).reduce((sum,qty)=>sum + (qty||0),0);
      const cartCount = document.getElementById("cartCount");
      if(cartCount) cartCount.textContent = total || 0;
      document.getElementById("heroItems").textContent = total || 0;
    }

    function money(n){return "â‚¹" + Math.round(Number(n)).toLocaleString("en-IN");}

    function showToast(msg){
      const toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 3500);
    }

    // âœ… FULL SUMMARY RENDER (UNCHANGED LOGIC)
    function renderSummary(){
      const itemsEl = document.getElementById("cartItems");
      itemsEl.innerHTML = "";
      
      let subtotal = 0;
      const activeItems = Object.entries(cart).filter(([id,qty]) => qty > 0 && PRODUCT_DB[id]);
      
      if(activeItems.length === 0){
        document.getElementById("emptyCart").style.display = "block";
        document.getElementById("checkoutBtn").disabled = true;
        renderEmptySummary();
        return;
      }
      
      document.getElementById("emptyCart").style.display = "none";
      document.getElementById("checkoutBtn").disabled = false;

      activeItems.forEach(([id,qty]) => {
        const product = PRODUCT_DB[id];
        const lineTotal = product.price * qty;
        subtotal += lineTotal;
        
        const item = document.createElement("div");
        item.className = "cart-item";
        item.innerHTML = `
          <div class="cart-img">
            <img src="${product.image}" alt="${product.name}" loading="lazy">
          </div>
          <div class="cart-info">
            <h4>${product.name}</h4>
            <div class="cart-meta">
              ${product.nfc ? '<span class="cart-nfc-badge">NFC Verified</span>' : ''} 
              ${product.stock > 0 ? `Stock: ${product.stock}` : 'Limited'}
            </div>
          </div>
          <div class="cart-qty">
            <button class="qty-btn" data-id="${id}" data-action="minus">âˆ’</button>
            <span class="qty-value">${qty}</span>
            <button class="qty-btn" data-id="${id}" data-action="plus">+</button>
          </div>
          <div class="cart-price">${money(product.price)}</div>
          <div class="cart-total">${money(lineTotal)}</div>
          <button class="cart-remove" data-id="${id}">Ã—</button>
        `;
        itemsEl.appendChild(item);
      });

      const shipping = subtotal >= 50000 ? 0 : 199;
      const tax = Math.round(subtotal * 0.18);
      const grandTotal = subtotal + shipping + tax;

      document.getElementById("subtotal").textContent = money(subtotal);
      document.getElementById("shipping").textContent = shipping ? money(shipping) : "FREE";
      document.getElementById("tax").textContent = money(tax);
      document.getElementById("grandTotal").textContent = money(grandTotal);
      document.getElementById("heroTotal").textContent = money(grandTotal);
    }

    function renderEmptySummary(){
      document.getElementById("subtotal").textContent = "â‚¹0";
      document.getElementById("shipping").textContent = "â‚¹0";
      document.getElementById("tax").textContent = "â‚¹0";
      document.getElementById("grandTotal").textContent = "â‚¹0";
      document.getElementById("heroTotal").textContent = "â‚¹0";
    }

    // âœ… FULL EVENT DELEGATION (UNCHANGED)
    document.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if(!btn || !document.getElementById("cartItems").contains(e.target)) return;
      
      const id = btn.dataset.id;
      if(!id || !PRODUCT_DB[id]) return;
      
      if(btn.classList.contains("qty-btn")){
        const action = btn.dataset.action;
        if(action === "plus"){
          cart[id] = (cart[id] || 0) + 1;
        } else {
          cart[id] = Math.max(0, (cart[id] || 0) - 1);
          if(cart[id] === 0) delete cart[id];
        }
        localStorage.setItem(CART_KEY, JSON.stringify(cart));
        showToast("Updated");
        renderSummary();
        updateCartCount();
      } else if(btn.classList.contains("cart-remove")){
        delete cart[id];
        localStorage.setItem(CART_KEY, JSON.stringify(cart));
        showToast("Removed");
        renderSummary();
        updateCartCount();
      }
    });

    document.getElementById("checkoutBtn").onclick = () => {
      const activeItems = Object.values(cart).filter(qty => qty > 0).length;
      if(activeItems === 0){
        showToast("Add pieces to your collection first");
        return;
      }
      location.href = "checkout.html";
    };

    // âœ… HAMBURGER + AUCTION TIMER
    document.getElementById("hamburger").addEventListener("click", function(){
      document.querySelector("header").classList.toggle("menu-open");
    });

    const auctionEnd = new Date("2025-12-24T18:00:00").getTime();
    function updateAuctionTimer(){
      const now = Date.now();
      const diff = auctionEnd - now;
      const timerEl = document.getElementById("auctionTimer");
      if(diff > 0){
        const days = Math.floor(diff / (1000*60*60*24));
        const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
        timerEl.innerHTML = `${days}d ${hours.toString().padStart(2,'0')}h`;
      } else {
        timerEl.innerHTML = "LIVE NOW!";
        timerEl.parentElement.style.background = "linear-gradient(135deg, var(--amethyst), var(--amethyst-light))";
      }
    }

    // âœ… GSAP MICRO-INTERACTIONS
    gsap.from(".hero-title", {scale:0.9, opacity:0, duration:1.2, ease:"back.out(1.7)"});
    gsap.from(".cart-stats .stat", {y:40, opacity:0, stagger:0.1, duration:0.8, delay:0.3});
    gsap.from(".cart-title", {scale:0.95, y:30, duration:0.8, scrollTrigger:{trigger:".cart-items", start:"top 85%"}});
    gsap.from(".summary-total", {scale:0.95, y:30, duration:0.8, scrollTrigger:{trigger:".cart-summary", start:"top 85%"}});

    // ðŸ”§ PERFECT INIT
    function init(){
      AOS.init({duration:1200, once:true, offset:100});
      renderAuth();
      updateCartCount();
      renderSummary();
      updateAuctionTimer();
      setInterval(updateAuctionTimer, 30000);
      document.getElementById("year").textContent = new Date().getFullYear();
    }

    if(document.readyState === 'loading'){
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>
</body>
</html>
