<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="theme-color" content="#3A0F5A"/>
  <title>Cart â€” Snehvastra</title>
  <meta name="description" content="Suratgarh live inventory, NFC verified cart, auction integration, collector bundles, secure checkout."/>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet"/>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

  <style>
    :root{
      --purple:#3A0F5A; --purple-dark:#2e0b4a; --success:#10B981; --gold:#F59E0B;
      --slate:#1F2024; --slate-mid:#3B3D45; --muted:#8E8F92; --glass:rgba(255,255,255,0.95);
      --radius:28px; --shadow-soft:0 40px 120px rgba(58,15,90,0.15); --ease:0.4s cubic-bezier(0.25,0.46,0.45,0.94);
      --max-width:1400px;
    }
    *{box-sizing:border-box;}
    body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#f8f7fc 0%,#f4f2f9 100%);color:var(--slate);overflow-x:hidden;}

    /* Perfect System Header */
    header{position:sticky;top:0;z-index:140;background:rgba(255,255,255,0.98);backdrop-filter:blur(24px);border-bottom:1px solid rgba(58,15,90,0.08);padding:20px 5%;display:flex;align-items:center;justify-content:space-between;}
    .brand{display:flex;gap:14px;align-items:center;cursor:pointer;}
    .logo{height:52px;border-radius:16px;box-shadow:0 16px 48px rgba(58,15,90,0.18);}
    nav ul{display:flex;gap:16px;list-style:none;margin:0;padding:0;}
    nav a{padding:14px 24px;border-radius:20px;font-weight:600;color:var(--muted);text-decoration:none;transition:all var(--ease);}
    nav a.active{background:rgba(58,15,90,0.08);color:var(--purple);}

    /* Enhanced Auction Banner */
    .auction-banner{position:fixed;top:88px;left:50%;transform:translateX(-50%);width:92%;max-width:520px;background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:#fff;padding:20px;border-radius:20px;text-align:center;font-weight:700;box-shadow:0 20px 60px rgba(58,15,90,0.4);z-index:100;}
    .auction-timer{background:rgba(255,255,255,0.95);backdrop-filter:blur(20px);padding:8px 16px;border-radius:16px;color:var(--slate);font-weight:700;font-size:1.1rem;margin-left:12px;animation:pulse 2s infinite;}

    /* Hero */
    .hero{max-width:var(--max-width);margin:140px auto 80px;padding:0 5%;text-align:center;background:#fff;border-radius:var(--radius);padding:80px;box-shadow:var(--shadow-soft);border:1px solid rgba(58,15,90,0.08);}
    .hero-title{font-family:'Clash Display',serif;font-size:clamp(4rem,10vw,6rem);background:linear-gradient(135deg,var(--purple),var(--purple-dark));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0 0 24px;}
    .hero-subtitle{font-size:1.4rem;color:var(--slate-mid);max-width:700px;margin:0 auto;line-height:1.8;}
    .cart-stats{display:flex;justify-content:center;gap:48px;margin-top:48px;flex-wrap:wrap;}
    .stat{background:var(--glass);padding:24px 32px;border-radius:24px;font-weight:700;color:var(--purple);backdrop-filter:blur(20px);border:1px solid rgba(58,15,90,0.1);text-align:center;min-width:140px;}

    /* Cart Grid */
    .cart-grid{max-width:var(--max-width);margin:0 auto 120px;padding:0 5%;display:grid;grid-template-columns:1fr 420px;gap:80px;align-items:start;}
    @media(max-width:1200px){.cart-grid{grid-template-columns:1fr;gap:60px;}}

    /* Cart Items */
    .cart-items{background:#fff;border-radius:var(--radius);padding:64px;box-shadow:var(--shadow-soft);border:1px solid rgba(58,15,90,0.08);}
    .cart-title{font-family:'Clash Display',serif;font-size:2.8rem;color:var(--purple);margin:0 0 48px;text-align:center;font-weight:900;}
    .cart-header{display:grid;grid-template-columns:80px 1fr auto auto 120px;gap:24px;align-items:center;padding:24px 0;font-size:1.1rem;font-weight:700;color:var(--slate-mid);border-bottom:2px solid rgba(58,15,90,0.08);margin-bottom:32px;}
    .cart-item{display:grid;grid-template-columns:80px 1fr auto auto 120px;gap:24px;align-items:center;padding:32px 0;border-bottom:1px solid rgba(58,15,90,0.04);transition:all var(--ease);}
    .cart-item:last-child{border-bottom:none;}
    .cart-item:hover{background:rgba(58,15,90,0.02);}
    
    .cart-img{width:64px;height:64px;border-radius:16px;overflow:hidden;box-shadow:0 12px 32px rgba(58,15,90,0.15);}
    .cart-img img{width:100%;height:100%;object-fit:cover;}
    
    .cart-info h4{font-family:'Clash Display',serif;font-size:1.4rem;color:var(--purple);margin:0 0 8px;font-weight:900;}
    .cart-meta{font-size:1rem;color:var(--slate-mid);line-height:1.6;}
    .cart-nfc-badge{background:var(--success);color:#fff;padding:4px 12px;border-radius:20px;font-size:0.85rem;font-weight:700;}
    
    .cart-qty{display:flex;align-items:center;gap:12px;background:var(--glass);padding:12px 20px;border-radius:24px;border:1px solid rgba(58,15,90,0.1);}
    .qty-btn{width:40px;height:40px;border-radius:50%;border:none;background:var(--purple);color:#fff;font-weight:900;font-size:1.2rem;cursor:pointer;transition:all var(--ease);}
    .qty-btn:hover{transform:scale(1.05);}
    .qty-value{font-weight:700;font-size:1.1rem;color:var(--purple);min-width:32px;text-align:center;}
    
    .cart-price{font-family:'Clash Display',serif;font-size:1.4rem;font-weight:900;color:var(--purple);}
    .cart-total{font-family:'Clash Display',serif;font-size:1.6rem;font-weight:900;background:linear-gradient(135deg,var(--purple),var(--purple-dark));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    
    .cart-remove{width:36px;height:36px;border-radius:50%;border:none;background:rgba(58,15,90,0.1);color:var(--purple);font-size:1.2rem;font-weight:900;cursor:pointer;transition:all var(--ease);display:flex;align-items:center;justify-content:center;}
    .cart-remove:hover{background:var(--purple);color:#fff;transform:scale(1.05);}

    /* Summary */
    .cart-summary{position:sticky;top:160px;background:#fff;border-radius:var(--radius);padding:64px;box-shadow:var(--shadow-soft);border:1px solid rgba(58,15,90,0.08);}
    .summary-title{font-family:'Clash Display',serif;font-size:2.4rem;color:var(--purple);margin:0 0 48px;text-align:center;font-weight:900;}
    .summary-item{display:flex;justify-content:space-between;padding:24px 0;font-size:1.2rem;border-bottom:1px solid rgba(58,15,90,0.08);}
    .summary-item:last-child{border-bottom:none;}
    .summary-label{font-weight:700;color:var(--slate);}
    .summary-value{font-family:'Clash Display',serif;font-size:1.5rem;font-weight:900;color:var(--purple);}
    .summary-total{background:linear-gradient(135deg,rgba(58,15,90,0.02),rgba(58,15,90,0.01));padding:40px;border-radius:24px;margin-top:32px;border:2px solid rgba(58,15,90,0.1);}
    .total-label{font-family:'Clash Display',serif;font-size:1.4rem;font-weight:700;color:var(--slate-mid);margin-bottom:16px;}
    .total-amount{font-family:'Clash Display',serif;font-size:4rem;font-weight:900;background:linear-gradient(135deg,var(--purple),var(--purple-dark));-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1;}
    
    .checkout-btn{width:100%;padding:32px;border:none;border-radius:28px;background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:#fff;font-family:'Clash Display',serif;font-size:1.6rem;font-weight:900;cursor:pointer;box-shadow:0 28px 90px rgba(58,15,90,0.45);transition:all var(--ease);height:96px;margin-top:24px;}
    .checkout-btn:hover{transform:translateY(-6px);box-shadow:0 40px 120px rgba(58,15,90,0.55);}
    .checkout-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none;}
    
    .continue-btn{width:100%;padding:20px;border-radius:24px;border:2px solid rgba(58,15,90,0.2);background:#fff;font-family:'Clash Display',serif;font-weight:700;font-size:1.1rem;color:var(--purple);cursor:pointer;transition:all var(--ease);margin-top:16px;}
    .continue-btn:hover{background:rgba(58,15,90,0.05);}

    .empty-cart{text-align:center;padding:120px 40px;color:var(--slate-mid);}
    .empty-title{font-family:'Clash Display',serif;font-size:3.6rem;color:var(--purple);margin:0 0 24px;}
    .empty-subtitle{font-size:1.3rem;margin:0 0 48px;line-height:1.8;}

    footer{padding:100px 5% 60px;text-align:center;color:var(--muted);border-top:1px solid rgba(183,185,189,0.12);font-size:0.95rem;}
    #toast{position:fixed;top:32px;right:32px;background:linear-gradient(135deg,var(--purple),var(--purple-dark));color:#fff;padding:24px 36px;border-radius:24px;box-shadow:0 28px 90px rgba(58,15,90,0.45);transform:translateX(500px);transition:all var(--ease);font-weight:700;z-index:500;max-width:420px;}
    #toast.show{transform:translateX(0);}

    @keyframes pulse{0%,100%{opacity:1;}50%{opacity:0.7;}}
    @media(max-width:768px){.cart-header,.cart-item{grid-template-columns:80px 1fr 120px;gap:16px;}.cart-price{display:none;}}
  </style>
</head>
<body>
  <!-- Perfect System Header -->
  <header>
    <div class="brand" onclick="location.href='index.html'">
      <img src="images/logo.final.png" class="logo" alt="Snehvastra"/>
      <div>
        <div style="font-family:'Clash Display',serif;font-size:1.2rem;color:var(--purple);">Snehvastra</div>
        <div style="font-size:0.85rem;color:var(--muted);">Collector Cart</div>
      </div>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="collection.html">Collection</a></li>
        <li><a href="auction.html">Auction</a></li>
        <li><a href="cart.html" class="active">Cart (<span id="cartCount">0</span>)</a></li>
        <li id="authArea"></li>
      </ul>
    </nav>
  </header>

  <div class="auction-banner">
    ðŸ”¥ SNEHVASTRA ONE AUCTION <span class="auction-timer" id="auctionTimer">Loading...</span>
  </div>

  <section class="hero" data-aos="fade-up">
    <h1 class="hero-title">Your Collection</h1>
    <p class="hero-subtitle">Suratgarh live inventory â€¢ NFC verified pieces â€¢ Collector pricing</p>
    <div class="cart-stats">
      <div class="stat" data-aos="fade-up" data-aos-delay="100">
        <div style="font-size:2.4rem;font-weight:900;color:var(--purple);">0</div>
        <div>Items</div>
      </div>
      <div class="stat" data-aos="fade-up" data-aos-delay="200">
        <div style="font-size:2.4rem;font-weight:900;color:var(--purple);">â‚¹0</div>
        <div>Total</div>
      </div>
      <div class="stat" data-aos="fade-up" data-aos-delay="300">
        <div style="font-size:2.4rem;font-weight:900;color:var(--success);">âœ“</div>
        <div>NFC Ready</div>
      </div>
    </div>
  </section>

  <div class="cart-grid">
    <section class="cart-items" data-aos="fade-right">
      <h2 class="cart-title">Selected Pieces</h2>
      
      <div class="cart-header">
        <span></span>
        <span>Piece Details</span>
        <span>Unit</span>
        <span>Price</span>
        <span>Total</span>
      </div>
      
      <div id="cartItems"></div>
      
      <div id="emptyCart" class="empty-cart" style="display:none;">
        <h2 class="empty-title" data-aos="zoom-in">Empty Cart</h2>
        <p class="empty-subtitle" data-aos="fade-up" data-aos-delay="200">Your collection is waiting. Discover Suratgarh's latest drops.</p>
        <a href="collection.html" class="continue-btn" style="max-width:320px;" data-aos="fade-up" data-aos-delay="400">Explore Collection</a>
      </div>
    </section>

    <aside class="cart-summary" data-aos="fade-left">
      <h2 class="summary-title">Collector Summary</h2>
      
      <div class="summary-item">
        <span class="summary-label">Subtotal</span>
        <span class="summary-value" id="subtotal">â‚¹0</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">Suratgarh Shipping</span>
        <span class="summary-value" id="shipping">â‚¹0</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">GST (18%)</span>
        <span class="summary-value" id="tax">â‚¹0</span>
      </div>
      
      <div class="summary-total">
        <div class="total-label">Grand Total</div>
        <div class="total-amount" id="grandTotal">â‚¹0</div>
      </div>
      
      <div style="font-size:1rem;color:var(--slate-mid);margin-top:32px;line-height:1.6;text-align:center;">
        Free shipping above â‚¹50,000 â€¢ NFC tags included â€¢ Suratgarh direct
      </div>
      
      <button class="checkout-btn" id="checkoutBtn" disabled>â†’ Secure Checkout</button>
      <button class="continue-btn" onclick="location.href='collection.html'">Continue Shopping</button>
    </aside>
  </div>

  <footer>
    Â© <span id="year"></span> Snehvastra. Suratgarh Studio â€¢ NFC Authenticated â€¢ Collector Grade.
  </footer>

  <div id="toast"></div>

  <script>
    // Perfect system sync
    const USER_KEY = "snehvastra_user"; const CART_KEY = "snehvastra_cart";
    let cart = JSON.parse(localStorage.getItem(CART_KEY) || "{}");
    const user = JSON.parse(localStorage.getItem(USER_KEY));

    const PRODUCT_DB = {
      "signature-tee": {name:"Signature Tee Black",price:4999,image:"images/products/tee.jpg",nfc:true,stock:12},
      "cloud-hoodie": {name:"Cloud Hoodie Indigo",price:19999,image:"images/products/hoodie.jpg",nfc:true,stock:8},
      "midnight-jacket": {name:"Midnight Jacket",price:29999,image:"images/products/jacket.jpg",nfc:true,stock:5},
      "snehvastra-one": {name:"Snehvastra ONE 1/1",price:125000,image:"images/products/one.jpg",nfc:true,stock:1,auction:true}
    };

    function renderAuth(){
      const authArea = document.getElementById("authArea");
      if(user && user.loggedIn){
        authArea.innerHTML = `<span style="color:var(--purple);font-weight:700;">Hi, ${user.name}</span>`;
      }
    }

    function updateCartCount(){
      const total = Object.values(cart).reduce((sum,qty)=>sum + (qty||0),0);
      document.getElementById("cartCount").textContent = total || 0;
      document.querySelectorAll('.stat div:first-child')[0].textContent = total;
    }

    function money(n){return "â‚¹" + Math.round(Number(n)).toLocaleString("en-IN");}

    function showToast(msg){
      const toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 3200);
    }

    function renderSummary(){
      const itemsEl = document.getElementById("cartItems");
      itemsEl.innerHTML = "";
      
      let subtotal = 0;
      const activeItems = Object.entries(cart).filter(([id,qty]) => qty > 0 && PRODUCT_DB[id]);
      
      if(activeItems.length === 0){
        document.getElementById("emptyCart").style.display = "block";
        document.getElementById("checkoutBtn").disabled = true;
        renderEmptySummary();
        return;
      }
      
      document.getElementById("emptyCart").style.display = "none";
      document.getElementById("checkoutBtn").disabled = false;

      activeItems.forEach(([id,qty]) => {
        const product = PRODUCT_DB[id];
        const lineTotal = product.price * qty;
        subtotal += lineTotal;
        
        const item = document.createElement("div");
        item.className = "cart-item";
        item.innerHTML = `
          <div class="cart-img">
            <img src="${product.image}" alt="${product.name}" loading="lazy">
          </div>
          <div class="cart-info">
            <h4>${product.name}</h4>
            <div class="cart-meta">
              ${product.nfc ? '<span class="cart-nfc-badge">NFC Verified</span>' : ''} 
              ${product.stock > 0 ? `Stock: ${product.stock}` : 'Limited'}
            </div>
          </div>
          <div class="cart-qty">
            <button class="qty-btn" data-id="${id}" data-action="minus">âˆ’</button>
            <span class="qty-value">${qty}</span>
            <button class="qty-btn" data-id="${id}" data-action="plus">+</button>
          </div>
          <div class="cart-price">${money(product.price)}</div>
          <div class="cart-total">${money(lineTotal)}</div>
          <button class="cart-remove" data-id="${id}">Ã—</button>
        `;
        itemsEl.appendChild(item);
      });

      const shipping = subtotal >= 50000 ? 0 : 199;
      const tax = Math.round(subtotal * 0.18);
      const grandTotal = subtotal + shipping + tax;

      document.getElementById("subtotal").textContent = money(subtotal);
      document.getElementById("shipping").textContent = shipping ? money(shipping) : "FREE";
      document.getElementById("tax").textContent = money(tax);
      document.getElementById("grandTotal").textContent = money(grandTotal);
      
      document.querySelectorAll('.stat div:first-child')[1].textContent = money(grandTotal);
    }

    function renderEmptySummary(){
      document.getElementById("subtotal").textContent = "â‚¹0";
      document.getElementById("shipping").textContent = "â‚¹0";
      document.getElementById("tax").textContent = "â‚¹0";
      document.getElementById("grandTotal").textContent = "â‚¹0";
      document.querySelectorAll('.stat div:first-child')[1].textContent = "â‚¹0";
    }

    // Event delegation
    document.getElementById("cartItems").addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if(!btn) return;
      
      const id = btn.dataset.id;
      if(!id || !PRODUCT_DB[id]) return;
      
      if(btn.classList.contains("qty-btn")){
        const action = btn.dataset.action;
        if(action === "plus"){
          cart[id] = (cart[id] || 0) + 1;
        } else {
          cart[id] = Math.max(0, (cart[id] || 0) - 1);
          if(cart[id] === 0) delete cart[id];
        }
        localStorage.setItem(CART_KEY, JSON.stringify(cart));
        showToast("Updated");
        renderSummary();
        updateCartCount();
      } else if(btn.classList.contains("cart-remove")){
        delete cart[id];
        localStorage.setItem(CART_KEY, JSON.stringify(cart));
        showToast("Removed");
        renderSummary();
        updateCartCount();
      }
    });

    document.getElementById("checkoutBtn").onclick = () => {
      const activeItems = Object.values(cart).filter(qty => qty > 0).length;
      if(activeItems === 0){
        showToast("Add pieces to your collection first");
        return;
      }
      location.href = "checkout.html";
    };

    // Auction timer
    const auctionDate = new Date("2025-12-24T18:00:00").getTime();
    setInterval(()=>{
      const diff = auctionDate - Date.now();
      const timer = document.getElementById("auctionTimer");
      if(diff > 0){
        const days = Math.floor(diff / (1000*60*60*24));
        const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
        timer.textContent = `${days}d ${hours}h`;
      } else {
        timer.textContent = "LIVE NOW!";
      }
    }, 60000);

    // Init
    AOS.init({duration: 1200, once: true});
    renderAuth();
    updateCartCount();
    renderSummary();
    document.getElementById("year").textContent = new Date().getFullYear();
  </script>
</body>
</html>
