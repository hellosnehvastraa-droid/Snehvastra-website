<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wishlist - Snehvastra</title>
  <meta name="theme-color" content="#3A0F5A" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />

  <style>
    :root{
      --purple:#3A0F5A; --slate:#22232A; --mid:#3B3D45;
      --muted:#6f6f7a; --paper:#F6F6F6; --radius:14px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(180deg,var(--paper),#fff);color:var(--slate)}

    header{position:sticky;top:0;background:#fff;padding:18px 5%;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #eee;z-index:100}
    .logo{height:46px}

    nav ul{display:flex;gap:14px;list-style:none;margin:0;padding:0;align-items:center}
    nav a{text-decoration:none;color:var(--mid);font-weight:600}
    nav a.active{color:var(--purple)}

    .user-box{display:flex;align-items:center;gap:10px}
    .user-name{font-weight:700;color:var(--purple)}
    .logout-btn{
      background:linear-gradient(135deg,var(--purple),#2e0b4a);
      color:#fff;border:none;border-radius:10px;
      padding:6px 12px;font-weight:700;cursor:pointer
    }

    .auction-banner{background:linear-gradient(135deg,var(--purple),#2e0b4a);color:#fff;padding:14px;text-align:center;font-weight:700}

    main{padding:60px 5%;max-width:1100px;margin:auto}
    .content{display:grid;grid-template-columns:1fr 320px;gap:24px}
    .panel{background:#fff;border-radius:16px;padding:22px;border:1px solid #eee}

    .wishlist-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
    .item-card{display:flex;gap:12px;padding:12px;border-radius:12px;border:1px solid #eee}
    .item-thumb{width:90px;height:90px;object-fit:cover;border-radius:12px}
    .item-title{font-weight:700}
    .item-meta{color:var(--muted)}

    .btn{padding:7px 11px;border:none;border-radius:8px;font-weight:700;cursor:pointer}
    .primary{background:linear-gradient(135deg,var(--purple),#2e0b4a);color:#fff}
    .ghost{background:#f2f2f2;color:var(--purple)}

    .empty{padding:40px;text-align:center;color:var(--muted)}

    footer{text-align:center;padding:40px;color:var(--muted)}

    .toast{position:fixed;top:120px;right:20px;background:linear-gradient(135deg,var(--purple),#2e0b4a);color:#fff;padding:16px 24px;border-radius:12px;transform:translateX(400px);transition:.3s}
    .toast.show{transform:translateX(0)}
  </style>
</head>

<body>

<header>
  <img src="images/logo.final.png" class="logo" />
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="collection.html">Collection</a></li>
      <li><a href="wishlist.html" class="active">Wishlist</a></li>
      <li><a href="auction.html">Auction</a></li>
      <li><a href="cart.html">Cart (<span id="cartCount">0</span>)</a></li>
      <li id="authArea"></li>
    </ul>
  </nav>
</header>

<div class="auction-banner">ðŸ”¥ SNEHVASTRA ONE AUCTION</div>

<main>

  <h1>Your Wishlist</h1>
  <p>Signed in as: <strong id="signedInName">Guest</strong></p>

  <div class="content">

    <div class="panel">
      <div id="wishlistArea"></div>
    </div>

    <aside class="panel">
      <div style="font-weight:700;margin-bottom:10px">Quick Actions</div>
      <button class="btn ghost" id="moveAllToCart">Move All To Cart</button><br><br>
      <button class="btn ghost" id="clearWishlist">Clear Wishlist</button>
    </aside>

  </div>

</main>

<footer>
  Â© <span id="currentYear"></span> Snehvastra
</footer>

<div class="toast" id="toast"></div>

<script>
const KEY_USER = 'snehvastra_user';
const KEY_USERS = 'snehvastra_users';
const KEY_CART = 'snehvastra_cart';
const KEY_WISHLIST = 'snehvastra_wishlist';

const SAMPLE_PRODUCTS = {
  "tee-black": { title:"Signature Tee", price:4999, img:"images/products/tee-black-1.jpg" },
  "hoodie-gray": { title:"Heritage Hoodie", price:6499, img:"images/products/hoodie-gray.jpg" }
};

function getUser(){ return JSON.parse(localStorage.getItem(KEY_USER)||"null"); }
function getCart(){ return JSON.parse(localStorage.getItem(KEY_CART)||"{}"); }
function setCart(c){ localStorage.setItem(KEY_CART,JSON.stringify(c)); updateCart(); }

function getWishlist(){
  const user=getUser();
  if(user && user.wishlist) return user.wishlist;
  return JSON.parse(localStorage.getItem(KEY_WISHLIST)||"[]");
}

function saveWishlist(arr){
  const user=getUser();
  if(user){
    const users=JSON.parse(localStorage.getItem(KEY_USERS)||"[]");
    const idx=users.findIndex(u=>u.id===user.id);
    if(idx>-1){
      users[idx].wishlist=arr;
      localStorage.setItem(KEY_USERS,JSON.stringify(users));
      user.wishlist=arr;
      localStorage.setItem(KEY_USER,JSON.stringify(user));
    }
  } else {
    localStorage.setItem(KEY_WISHLIST,JSON.stringify(arr));
  }
}

function renderWishlist(){
  const w=getWishlist();
  const nameEl=document.getElementById("signedInName");
  const user=getUser();
  nameEl.textContent=user?user.name:"Guest";

  if(w.length===0){
    wishlistArea.innerHTML="<div class='empty'>Your wishlist is empty.</div>";
    return;
  }

  wishlistArea.innerHTML='<div class="wishlist-grid">'+w.map(id=>{
    const p=SAMPLE_PRODUCTS[id];
    return `
      <div class="item-card">
        <img src="${p.img}" class="item-thumb">
        <div>
          <div class="item-title">${p.title}</div>
          <div class="item-meta">â‚¹${p.price}</div><br>
          <button class="btn primary" onclick="moveToCart('${id}')">Move</button>
          <button class="btn ghost" onclick="removeItem('${id}')">Remove</button>
        </div>
      </div>
    `;
  }).join("")+'</div>';
}

function moveToCart(id){
  const cart=getCart();
  cart[id]=(cart[id]||0)+1;
  setCart(cart);
  saveWishlist(getWishlist().filter(x=>x!==id));
  renderWishlist();
  showToast("Moved to Cart");
}

function removeItem(id){
  saveWishlist(getWishlist().filter(x=>x!==id));
  renderWishlist();
  showToast("Removed");
}

document.getElementById("moveAllToCart").onclick=()=>{
  const w=getWishlist();
  if(!w.length) return;
  const cart=getCart();
  w.forEach(id=>cart[id]=(cart[id]||0)+1);
  setCart(cart);
  saveWishlist([]);
  renderWishlist();
  showToast("All Moved To Cart");
};

document.getElementById("clearWishlist").onclick=()=>{
  saveWishlist([]);
  renderWishlist();
  showToast("Wishlist Cleared");
};

function updateCart(){
  const t=Object.values(getCart()).reduce((a,b)=>a+b,0);
  document.getElementById("cartCount").textContent=t;
}

function showToast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2500);
}

/* âœ… AUTH UI */
const authArea=document.getElementById("authArea");
const user=getUser();
if(user){
  authArea.innerHTML=`
    <span class="user-name">${user.name}</span>
    <button class="logout-btn" onclick="logout()">Logout</button>
  `;
}else{
  authArea.innerHTML=`
    <a href="user-login.html">Login</a>
    <a href="user-register.html">Register</a>
  `;
}
function logout(){
  localStorage.removeItem(KEY_USER);
  location.reload();
}

window.onload=()=>{
  document.getElementById("currentYear").textContent=new Date().getFullYear();
  updateCart();
  renderWishlist();
};
</script>

</body>
</html>
