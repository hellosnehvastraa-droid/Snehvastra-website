<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SNEHVASTRA ONE — Auction · Snehvastra V2</title>
  <meta name="description" content="Live bidding — cinematic Snehvastra ONE auction. Frosted-glass bids, real-time timers, and Sneh (Auction Advisor) guiding every move." />
  <meta name="theme-color" content="#3A0F5A" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@500;600;700&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    /* ------------------------------
       Design tokens
    ------------------------------ */
    :root{
      --purple:#3A0F5A;
      --purple-2:#7B3BBE;
      --purple-glow: rgba(153, 95, 255, 0.22);
      --slate:#1f1f25;
      --muted:#6d6c73;
      --silver:#C7C7CE;
      --paper:#F6F6F8;
      --radius:14px;
      --ease: cubic-bezier(.2,.9,.25,1);
      --max:1240px;
    }

    /* ------------------------------
       Reset & base
    ------------------------------ */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Poppins', sans-serif;
      color:var(--slate);
      background: linear-gradient(180deg,#f6f5f8,#efeaf5);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
    }
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%}

    /* ------------------------------
       Header (consistent V2)
    ------------------------------ */
    header{
      position:sticky;top:0;z-index:120;
      backdrop-filter: blur(8px) saturate(120%);
      background: rgba(255,255,255,0.72);
      border-bottom: 1px solid rgba(58,15,90,0.04);
      padding:14px 24px;
    }
    .nav {
      max-width:var(--max);margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:18px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{height:52px;filter:drop-shadow(0 10px 30px rgba(58,15,90,0.10))}
    .brand .name{font-weight:700;color:var(--purple);font-family:'Clash Display',serif}
    nav ul{display:flex;gap:12px;list-style:none;margin:0;padding:0;align-items:center}
    nav a{padding:8px 10px;border-radius:10px;font-weight:600;color:var(--purple);transition:all .2s var(--ease)}
    nav a:hover, nav a.active{background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));box-shadow:0 10px 30px rgba(58,15,90,0.04);color:var(--slate)}

    /* ------------------------------
       Hero (animated purple gradient)
    ------------------------------ */
    .hero {
      position:relative;
      overflow:hidden;
      padding:96px 20px 84px;
      margin-top:18px;
      text-align:center;
    }
    .hero .bg {
      position:absolute;inset:0;background:linear-gradient(120deg,#3A0F5A 0%, #7B3BBE 40%, #2A0D3F 100%);
      z-index:-2;filter:contrast(1.05) saturate(1.05);
      transform-origin:center;
      animation: heroShift 18s ease-in-out infinite alternate;
    }
    @keyframes heroShift { from{transform:scale(1.02) rotate(0.01deg)} to{transform:scale(1.06) rotate(.02deg)} }
    .hero .pattern {
      position:absolute;left:-6%;top:-10%;width:70%;height:110%;background:radial-gradient(circle at 20% 30%, rgba(255,255,255,0.06), transparent 20%), linear-gradient(90deg, rgba(255,255,255,0.02), transparent 60%);
      filter:blur(48px);z-index:-1;mix-blend-mode:overlay;
    }
    .hero h1{
      font-family:'Clash Display',serif;color:#fff;font-size:clamp(2.2rem,4.6vw,3.6rem);letter-spacing:-0.6px;margin-bottom:12px;
      text-shadow:0 12px 40px rgba(58,15,90,0.35);
    }
    .hero p{
      color:rgba(255,255,255,0.9);max-width:920px;margin:0 auto;font-size:1.05rem;line-height:1.6;
    }
    .hero .cta-row{margin-top:28px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap}

    /* Glass button (purple gradient glass) */
    .btn {
      display:inline-flex;align-items:center;gap:10px;justify-content:center;
      padding:14px 22px;border-radius:14px;border:1px solid rgba(255,255,255,0.06);
      background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      color:#fff;font-weight:700;cursor:pointer;backdrop-filter: blur(6px) saturate(120%);
      box-shadow: 0 14px 40px rgba(58,15,90,0.28), inset 0 1px 0 rgba(255,255,255,0.14);
      transition: transform .25s var(--ease), box-shadow .25s var(--ease);
    }
    .btn.primary {
      background: linear-gradient(135deg, var(--purple-2), var(--purple));
      box-shadow: 0 18px 50px rgba(58,15,90,0.36);
    }
    .btn.ghost {
      background: rgba(255,255,255,0.08);
      color: #fff; border:1px solid rgba(255,255,255,0.08);
      box-shadow: none;
    }
    .btn:hover{transform:translateY(-3px)}

    /* ------------------------------
       Main layout
    ------------------------------ */
    .wrap{max-width:var(--max);margin:40px auto;padding:0 20px;display:flex;flex-direction:column;gap:36px}

    /* Auctions grid – frosted cards */
    .auctions-grid{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:24px;
    }
    @media (max-width:1080px){ .auctions-grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:720px){ .auctions-grid{grid-template-columns:1fr} .hero{padding:64px 20px} }

    .auction-card{
      border-radius:18px;overflow:hidden;background:linear-gradient(180deg,#ffffff, #fbfbff);
      border:1px solid rgba(58,15,90,0.06);
      box-shadow: 0 22px 60px rgba(58,15,90,0.06);
      display:flex;flex-direction:column;transition: transform .25s var(--ease), box-shadow .25s var(--ease);
    }
    .auction-card:hover{ transform: translateY(-8px); box-shadow:0 34px 92px rgba(58,15,90,0.12) }

    .media{
      height:260px;display:flex;align-items:center;justify-content:center;background:linear-gradient(120deg, rgba(58,15,90,0.05), rgba(255,255,255,0.9));
      position:relative;font-size:4.2rem;color:var(--purple);
    }
    .media img{width:100%;height:100%;object-fit:cover;display:block}
    .live-dot{ position:absolute; top:14px; right:14px; width:12px;height:12px;border-radius:50%; background:linear-gradient(90deg,#ffb3ff,#b27aff); box-shadow:0 0 18px rgba(147,78,255,0.24); animation:pulse 1.6s infinite;}
    @keyframes pulse { 0%{transform:scale(1);opacity:1} 50%{transform:scale(1.25);opacity:.55} 100%{transform:scale(1);opacity:1} }

    .body{
      padding:20px 22px 28px;display:flex;flex-direction:column;gap:14px;
    }
    .title{ font-family:'Clash Display',serif;color:var(--purple);font-size:1.1rem }
    .meta{ color:var(--muted); font-size:0.95rem }
    .current-bid{ font-size:1.6rem;font-weight:900;color:var(--purple) }
    .bid-info{ display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:6px }

    .controls{ display:flex;gap:12px;margin-top:12px; align-items:center }
    .input {
      flex:1;padding:12px 14px;border-radius:12px;border:1px solid rgba(58,15,90,0.12);font-weight:700;text-align:center;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.5);
    }
    .bid-cta{ padding:12px 18px;border-radius:12px;border:none;background:linear-gradient(135deg,var(--purple-2),var(--purple));color:#fff;font-weight:800;cursor:pointer;box-shadow:0 12px 36px rgba(58,15,90,0.28) }
    .bid-cta:hover{transform:translateY(-3px)}

    .timer {
      margin-top:10px;padding:8px 12px;border-radius:10px;background:linear-gradient(180deg, rgba(58,15,90,0.03), rgba(255,255,255,0.5));
      color:var(--purple);font-family:'Clash Display',serif;font-weight:700;display:inline-block;
    }

    /* Auction advisor card */
    .advisor {
      position:sticky; top:100px; align-self:flex-start;
      background:linear-gradient(180deg,#fff,#fbfbff); border-radius:16px; padding:20px; border:1px solid rgba(58,15,90,0.06);
      box-shadow:0 20px 60px rgba(58,15,90,0.05); width:320px;
    }
    .advisor h4{font-family:'Clash Display',serif;color:var(--purple);margin:0 0 8px}
    .advisor p{color:var(--muted);font-size:0.95rem;margin:0 0 12px}
    .advisor .ai-input{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(58,15,90,0.08);margin-bottom:10px}
    .advisor .ai-res{color:var(--muted);min-height:28px}

    /* Leaderboard / Footer area */
    .leaderboard-wrap{display:flex;gap:24px;align-items:flex-start;flex-wrap:wrap}
    .leaderboard{
      flex:1;min-width:320px;background:linear-gradient(180deg,#fff,#fbfbff);padding:20px;border-radius:16px;border:1px solid rgba(58,15,90,0.06);
      box-shadow:0 20px 60px rgba(58,15,90,0.05);
    }
    .leaderboard h3{font-family:'Clash Display',serif;color:var(--purple);margin:0 0 12px}
    .leader-row{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;border:1px solid rgba(58,15,90,0.03);margin-bottom:10px;background:linear-gradient(180deg,#fff,#fbfbff)}
    .leader-rank{font-weight:900;color:var(--purple);font-size:1.1rem}
    .leader-name{color:var(--muted);font-weight:700}
    .leader-bid{font-weight:900;color:var(--purple)}

    /* Floating AI orb — primary */
    .ai-orb{
      position:fixed;right:22px;bottom:22px;width:66px;height:66px;border-radius:999px;background:linear-gradient(135deg,var(--purple-2),var(--purple));
      color:#fff;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.3rem;cursor:pointer;
      box-shadow:0 22px 60px rgba(58,15,90,0.34);z-index:1000;border:1px solid rgba(255,255,255,0.06);
    }
    .ai-orb:focus{outline:3px solid rgba(186,178,255,0.16)}

    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(12,10,15,0.48);display:none;align-items:center;justify-content:center;z-index:1200;padding:20px}
    .modal{background:#fff;padding:20px;border-radius:16px;max-width:720px;width:100%;box-shadow:0 30px 120px rgba(0,0,0,0.45)}
    .modal h3{font-family:'Clash Display',serif;color:var(--purple);margin:0 0 8px}
    .modal .controls{display:flex;gap:10px;margin-top:12px}

    /* toast */
    #toast{position:fixed;top:18px;right:18px;background:linear-gradient(135deg,var(--purple-2),var(--purple));color:#fff;padding:12px 18px;border-radius:12px;box-shadow:0 16px 40px rgba(58,15,90,0.30);display:none;z-index:1300}
    /* accessibility */
    :focus{outline:none}
    button:focus, input:focus{outline:3px solid rgba(186,178,255,0.14);outline-offset:3px;border-radius:10px}

  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="nav">
      <div class="brand">
        <img src="images/logo.final.png" alt="Snehvastra logo" />
        <div class="name">Snehvastra</div>
      </div>

      <nav aria-label="Main navigation">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="collection.html">Collection</a></li>
          <li><a href="auction.html" class="active">Auction</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="cart.html">Cart (<span id="cartCount">0</span>)</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" role="banner" aria-labelledby="heroTitle">
    <div class="bg" aria-hidden="true"></div>
    <div class="pattern" aria-hidden="true"></div>

    <h1 id="heroTitle">SNEHVASTRA ONE — Live Auction</h1>
    <p>
      Join the cinematic drop — limited pieces, NFC-backed authenticity, curated rarity. Bids are live; Sneh (Auction Advisor) helps with strategy and rules.
    </p>

    <div class="cta-row">
      <button class="btn primary" onclick="scrollToGrid()">Start Bidding</button>
      <button class="btn ghost" onclick="openSnehModal();">Ask Sneh (Auction Advisor)</button>
      <button class="btn ghost" onclick="window.open('https://wa.me/917597152209','_blank')">Auction Help (WhatsApp)</button>
    </div>
  </section>

  <!-- Main wrap -->
  <div class="wrap" role="main">

    <!-- Grid + Advisor layout -->
    <div style="display:grid;grid-template-columns:1fr 360px;gap:28px;align-items:start;">
      <!-- Auctions Grid -->
      <div>
        <h2 style="font-family:'Clash Display',serif;color:var(--purple);margin-bottom:14px">Live Auction Items</h2>

        <div class="auctions-grid" id="auctionsGrid" aria-live="polite">
          <!-- Cards will be rendered here (server or JS rendered below). For now we include three sample cards as V2-ready markup. -->

          <!-- ITEM 1 -->
          <article class="auction-card" data-id="1" aria-labelledby="title1">
            <div class="media" aria-hidden="false">
              <div class="live-dot" aria-hidden="true"></div>
              <img src="images/item-tee.jpg" alt="Signature Tee — Matte Black" loading="lazy" />
            </div>

            <div class="body">
              <div>
                <div id="title1" class="title">Signature Tee — Matte Black</div>
                <div class="meta">Unique drop — NFC tag included</div>
              </div>

              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div class="current-bid" id="bidDisplay1">₹12,500</div>
                <div class="meta">12 bids · 3 watchers</div>
              </div>

              <div class="bid-info">
                <div style="flex:1">
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input id="bidInput1" class="input" type="number" placeholder="₹13,000+" aria-label="Enter bid amount for item 1" />
                    <button class="bid-cta" onclick="placeBid(1)">BID</button>
                  </div>
                </div>
              </div>

              <div class="timer" id="timer1">02:47:23</div>
            </div>
          </article>

          <!-- ITEM 2 -->
          <article class="auction-card" data-id="2" aria-labelledby="title2">
            <div class="media">
              <div class="live-dot"></div>
              <img src="images/item-bomber.jpg" alt="Crafted Bomber — Olive" loading="lazy" />
            </div>

            <div class="body">
              <div>
                <div id="title2" class="title">Crafted Bomber — Olive</div>
                <div class="meta">Limited size run • Hand-stitched trims</div>
              </div>

              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div class="current-bid" id="bidDisplay2">₹28,500</div>
                <div class="meta">8 bids · 7 watchers</div>
              </div>

              <div class="bid-info">
                <div style="flex:1">
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input id="bidInput2" class="input" type="number" placeholder="₹29,000+" aria-label="Enter bid amount for item 2" />
                    <button class="bid-cta" onclick="placeBid(2)">BID</button>
                  </div>
                </div>
              </div>

              <div class="timer" id="timer2">01:23:45</div>
            </div>
          </article>

          <!-- ITEM 3 -->
          <article class="auction-card" data-id="3" aria-labelledby="title3">
            <div class="media">
              <div class="live-dot"></div>
              <img src="images/item-sneaker.jpg" alt="Drop Edition Sneakers" loading="lazy" />
            </div>

            <div class="body">
              <div>
                <div id="title3" class="title">Drop Edition Sneakers</div>
                <div class="meta">Hand-finished sole • Collector serial</div>
              </div>

              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div class="current-bid" id="bidDisplay3">₹45,000</div>
                <div class="meta">21 bids · 15 watchers</div>
              </div>

              <div class="bid-info">
                <div style="flex:1">
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input id="bidInput3" class="input" type="number" placeholder="₹46,000+" aria-label="Enter bid amount for item 3" />
                    <button class="bid-cta" onclick="placeBid(3)">BID</button>
                  </div>
                </div>
              </div>

              <div class="timer" id="timer3">00:56:12</div>
            </div>
          </article>

        </div>
      </div>

      <!-- Advisor column -->
      <aside>
        <div class="advisor" role="complementary" aria-labelledby="advisorTitle">
          <h4 id="advisorTitle">Sneh — Auction Advisor</h4>
          <p>Ask Sneh for bidding strategy, auction rules, or help with NFC authentication and checkout flow.</p>

          <input id="advisorInput" class="ai-input" placeholder="e.g. 'How much should I bid?'" aria-label="Ask Sneh auction advisor" />
          <div style="display:flex;gap:8px;margin-top:10px;">
            <button class="btn" onclick="askAdvisor()">Ask</button>
            <button class="btn ghost" onclick="playAdvisorGuide()">▶ Guide</button>
          </div>

          <div class="ai-res" id="advisorRes" aria-live="polite" style="margin-top:12px"></div>

          <div style="margin-top:18px">
            <h4 style="margin:0 0 8px;color:var(--purple);font-family:'Clash Display',serif">Quick Rules</h4>
            <ul style="color:var(--muted);margin:8px 0 0;padding-left:18px;line-height:1.6">
              <li>Highest bid at timer end wins.</li>
              <li>Bids are final — confirm payment within 24 hours.</li>
              <li>NFC tag is shipped with authenticated serial.</li>
            </ul>
          </div>
        </div>
      </aside>
    </div>

    <!-- Leaderboard -->
    <div class="leaderboard-wrap" style="align-items:flex-start;">
      <div class="leaderboard" aria-labelledby="leaderTitle">
        <h3 id="leaderTitle">Top Bidders</h3>
        <div id="leaders">
          <div class="leader-row"><div class="leader-rank">1</div><div class="leader-name">arun_v</div><div class="leader-bid">₹1.2L</div></div>
          <div class="leader-row"><div class="leader-rank">2</div><div class="leader-name">priya.k</div><div class="leader-bid">₹98K</div></div>
          <div class="leader-row"><div class="leader-rank">3</div><div class="leader-name">nikhil_design</div><div class="leader-bid">₹87K</div></div>
        </div>
      </div>

      <div style="min-width:320px">
        <div class="card" style="padding:18px;border-radius:16px;">
          <h4 style="margin:0 0 8px;color:var(--purple);font-family:'Clash Display',serif">Auction Notes</h4>
          <p style="color:var(--muted);margin:0 0 12px">Payments must be completed within 24 hours of auction close. All items have NFC authenticity; scan the tag after delivery to register your piece.</p>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn ghost" onclick="window.location.href='shipping.html'">Shipping Policy</button>
            <button class="btn ghost" onclick="window.open('https://wa.me/917597152209','_blank')">Contact Support</button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Footer -->
  <footer style="max-width:var(--max);margin:60px auto 120px;padding:0 20px;color:var(--muted);text-align:center">
    © <span id="year"></span> Snehvastra · All rights reserved.
  </footer>

  <!-- Floating AI orb -->
  <button class="ai-orb" id="aiOrb" aria-label="Open Sneh — Auction Advisor" title="Ask Sneh">
    S
  </button>

  <!-- Modal (Sneh full assistant) -->
  <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <h3 id="modalTitle">Sneh — Full Auction Advisor</h3>
      <p style="color:var(--muted);margin:6px 0 12px">Ask anything about bidding, auction rules, or NFC authentication. You can also play an auction guide.</p>

      <label for="modalInput" style="font-weight:700;color:var(--purple);display:block;margin-bottom:8px">Your question</label>
      <input id="modalInput" class="ai-input" placeholder="e.g. 'When does bidding extend?'" />

      <div class="controls" style="margin-top:12px">
        <button class="btn" id="modalAsk">Ask</button>
        <button class="btn ghost" id="modalGuide">▶ Guide</button>
        <button class="btn ghost" id="modalClose">Close</button>
      </div>

      <div id="modalRes" class="ai-response" style="margin-top:12px;color:var(--muted)"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast">Saved</div>

  <script>
    /**************************************************************************
     * Basic state (will be replaced by server / websocket in production)
     **************************************************************************/
    // Cart sync
    let cart = JSON.parse(localStorage.getItem('snehvastra_cart') || '{}');
    function updateCartCount(){
      const total = Object.values(cart).reduce((s,v)=>s+(v||0),0);
      document.getElementById('cartCount').textContent = total;
    }

    // Sample bids state
    const bids = {1:12500,2:28500,3:45000};
    const watchers = {1:3,2:7,3:15};
    const bidCounts = {1:12,2:8,3:21};

    // Auction timers (relative to now; in production use server timestamps + websockets)
    const timers = {
      1: Date.now() + (2*3600 + 47*60 + 23)*1000, // 2h47m23s
      2: Date.now() + (1*3600 + 23*60 + 45)*1000,
      3: Date.now() + (56*60 + 12)*1000
    };

    // Utility: format INR
    function fmtINR(x){ return '₹' + Number(x).toLocaleString('en-IN'); }

    // Place bid (client-side simulation)
    function placeBid(id){
      const input = document.getElementById('bidInput' + id);
      const val = parseInt(input.value);
      if(!val || val <= bids[id]) { showToast('Enter a higher bid'); input.focus(); return; }

      // update state
      bids[id] = val;
      bidCounts[id] = (bidCounts[id]||0) + 1;
      watchers[id] = (watchers[id]||0) + 1;

      // update UI
      document.getElementById('bidDisplay' + id).textContent = fmtINR(val);
      // find the .meta text and update (simple approach)
      const card = document.querySelector(`[data-id="${id}"]`);
      if(card) {
        const meta = card.querySelector('.meta');
        if(meta) meta.textContent = `${bidCounts[id]} bids · ${watchers[id]} watchers`;
      }
      input.value = '';
      showToast('Bid placed — confirm in checkout');

      // Optional: small extension rule — if bid placed in last 60s, extend by 90s
      const remaining = timers[id] - Date.now();
      if(remaining <= 60000){
        timers[id] = timers[id] + 90000;
        showToast('Auction extended due to last-minute bid');
      }
    }

    // Timers: update DOM every second
    function updateTimers(){
      for(const id in timers){
        const el = document.getElementById('timer' + id);
        const diff = timers[id] - Date.now();
        if(!el) continue;
        if(diff <= 0){ el.textContent = 'Closed'; continue; }
        const h = Math.floor(diff/3600000);
        const m = Math.floor((diff%3600000)/60000);
        const s = Math.floor((diff%60000)/1000);
        el.textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
      }
    }

    // Main countdown (for banner or event) — using a static event date as placeholder
    const mainEvent = new Date('2025-12-01T18:00:00').getTime();
    function updateMainEvent(){
      const diff = mainEvent - Date.now();
      const bannerEl = document.getElementById('heroTitle');
      // we only use for informational purposes — hero already displays title
      if(diff <= 0){
        // event live
      }
    }

    // Scroll to grid
    function scrollToGrid(){
      const el = document.getElementById('auctionsGrid');
      if(el) el.scrollIntoView({behavior:'smooth',block:'start'});
    }

    // Advisor (simple rule-based assistant for now)
    function generateAdvisorResponse(q){
      if(!q || !q.trim()) return "Try: 'How much should I bid?', 'How does extension work?', or 'What is NFC authentication?'";
      q = q.toLowerCase();
      if(q.includes('how much') || q.includes('how much should') || q.includes('suggest')) {
        return "Sneh suggests bidding 5–10% above current if you want a high chance, or set a 'sniper' higher bid and monitor the timer.";
      }
      if(q.includes('extension') || q.includes('extend') || q.includes('last minute')) {
        return "We extend the auction by 90 seconds if a bid arrives within the final 60 seconds — to avoid sniping.";
      }
      if(q.includes('nfc') || q.includes('auth') || q.includes('authenticate')) {
        return "Each SNEHVASTRA ONE piece includes an NFC tag with a unique serial. Scan post-delivery to register ownership and validity.";
      }
      if(q.includes('pay') || q.includes('payment') || q.includes('invoice')) {
        return "Winners receive an invoice and must complete payment within 24 hours to confirm shipment and NFC registration.";
      }
      return "Great question. If you'd like, ask for 'guide' to hear a short auction walkthrough.";
    }

    function askAdvisor(){
      const q = document.getElementById('advisorInput').value || '';
      const res = generateAdvisorResponse(q);
      document.getElementById('advisorRes').textContent = res;
      showToast('Sneh answered — see advisor panel');
    }

    // TTS guide
    let ttsUtter = null;
    function playAdvisorGuide(){
      const text = "Welcome to Snehvastra One Auction. To win, bid above the current highest price. If you bid in the final minute, the auction extends by ninety seconds. Winners must pay within 24 hours. NFC tags authenticate every piece.";
      if('speechSynthesis' in window){
        if(ttsUtter){ speechSynthesis.cancel(); ttsUtter = null; return; } // toggle stop
        ttsUtter = new SpeechSynthesisUtterance(text);
        ttsUtter.rate = 0.98; ttsUtter.pitch = 0.95;
        const voices = window.speechSynthesis.getVoices();
        if(voices && voices.length) ttsUtter.voice = voices.find(v => /en-?gb|en-?us|default/i.test(v.lang)) || voices[0];
        ttsUtter.onend = ()=> { ttsUtter = null; };
        speechSynthesis.speak(ttsUtter);
      } else {
        showToast('TTS not supported');
      }
    }

    // Modal controls (full Sneh assistant)
    const aiOrb = document.getElementById('aiOrb');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalInput = document.getElementById('modalInput');
    const modalAsk = document.getElementById('modalAsk');
    const modalRes = document.getElementById('modalRes');
    const modalGuide = document.getElementById('modalGuide');
    const modalClose = document.getElementById('modalClose');

    aiOrb.addEventListener('click', ()=> openSnehModal());
    function openSnehModal(){
      modalBackdrop.style.display = 'flex';
      modalBackdrop.setAttribute('aria-hidden','false');
      modalInput.focus();
    }
    function closeSnehModal(){
      modalBackdrop.style.display = 'none';
      modalBackdrop.setAttribute('aria-hidden','true');
      modalRes.textContent = '';
    }
    modalClose.addEventListener('click', closeSnehModal);
    modalAsk.addEventListener('click', ()=>{
      const q = modalInput.value || '';
      modalRes.textContent = generateAdvisorResponse(q.toLowerCase());
    });
    modalGuide.addEventListener('click', playAdvisorGuide);
    modalBackdrop.addEventListener('click', (e)=>{ if(e.target === modalBackdrop) closeSnehModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeSnehModal(); });

    // Toast helper
    const toastEl = document.getElementById('toast');
    let toastTimer = null;
    function showToast(msg, ms=2600){
      toastEl.textContent = msg;
      toastEl.style.display = 'block';
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>{ toastEl.style.display = 'none'; }, ms);
    }

    // Initialization
    window.addEventListener('load', ()=>{
      updateCartCount();
      document.getElementById('year').textContent = new Date().getFullYear();
      updateTimers();
      setInterval(updateTimers, 1000);
    });

    // Accessibility small helpers (focus trap in modal)
    modalBackdrop.addEventListener('keydown', (e)=>{
      if(e.key !== 'Tab') return;
      const focusable = modalBackdrop.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      if(!focusable.length) return;
      const first = focusable[0], last = focusable[focusable.length-1];
      if(e.shiftKey && document.activeElement === first){ last.focus(); e.preventDefault(); }
      else if(!e.shiftKey && document.activeElement === last){ first.focus(); e.preventDefault(); }
    });

  </script>
</body>
</html>
