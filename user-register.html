<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#3A0F5A" />
  <title>Register - Snehvastra</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@600&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet"/>

  <style>
    :root{--purple:#3A0F5A;--mid:#444;--muted:#999;--radius:14px}
    body{margin:0;font-family:'Poppins',sans-serif;background:#f7f6fb}
    header{background:#fff;padding:18px 5%;display:flex;justify-content:space-between;align-items:center}
    .logo{height:44px}
    nav a{text-decoration:none;margin-left:14px;color:#555;font-weight:600}
    main{max-width:520px;margin:80px auto;background:#fff;padding:40px;border-radius:var(--radius);box-shadow:0 10px 40px rgba(0,0,0,0.08)}
    h1{font-family:'Clash Display';text-align:center;color:var(--purple)}
    .form-group{margin-bottom:18px}
    label{display:block;margin-bottom:6px;font-weight:600;color:#444}
    input{width:100%;padding:14px;border-radius:12px;border:1px solid #ccc;font-size:1rem}

    .password-container{position:relative}
    .password-container input{padding-right:56px}
    .password-toggle{
      position:absolute;
      right:12px;
      top:50%;
      transform:translateY(-50%);
      background:none;
      border:none;
      font-size:1.1rem;
      cursor:pointer;
      color:#444;
    }

    button{
      width:100%;
      padding:16px;
      border:none;
      border-radius:14px;
      background:#3A0F5A;
      color:white;
      font-weight:700;
      cursor:pointer
    }

    .error{color:red;font-size:0.85rem;display:none}

    .toast{
      position:fixed;
      top:20px;
      right:20px;
      background:#3A0F5A;
      color:#fff;
      padding:14px 18px;
      border-radius:10px;
      transform:translateX(400px);
      transition:.3s
    }
    .toast.show{transform:translateX(0)}
  </style>
</head>

<body>

<header>
  <img src="images/logo.final.png" class="logo">
  <nav>
    <a href="index.html">Home</a>
    <a href="collection.html">Collection</a>
    <a href="user-login.html">Login</a>
  </nav>
</header>

<main>
  <h1>Create Account</h1>

  <form id="register-form">

    <div class="form-group">
      <label>Full Name</label>
      <input type="text" id="fullname" required>
    </div>

    <div class="form-group">
      <label>Email Address</label>
      <input type="email" id="email" required>
    </div>

    <div class="form-group">
      <label>Password</label>
      <div class="password-container">
        <input type="password" id="password" required>
        <button type="button" class="password-toggle" id="togglePass">üëÅ</button>
      </div>
    </div>

    <div class="form-group">
      <label>Confirm Password</label>
      <div class="password-container">
        <input type="password" id="confirmpassword" required>
        <button type="button" class="password-toggle" id="toggleConfirm">üëÅ</button>
      </div>
    </div>

    <div class="form-group">
      <input type="checkbox" id="terms"> I accept Terms & Privacy Policy
    </div>

    <button>Create Account</button>
  </form>
</main>

<div id="toast" class="toast"></div>

<script>
  const USERS_KEY = "snehvastra_users";
  const USER_KEY  = "snehvastra_user";

  // ‚úÖ AUTO REDIRECT IF LOGGED IN
  const existingUser = JSON.parse(localStorage.getItem(USER_KEY));
  if(existingUser && existingUser.loggedIn){
    location.href = "index.html";
  }

  // ‚úÖ PASSWORD TOGGLES ‚Äî FIXED
  const pass = document.getElementById("password");
  const confirmPass = document.getElementById("confirmpassword");
  document.getElementById("togglePass").onclick = ()=> toggle(pass, togglePass);
  document.getElementById("toggleConfirm").onclick = ()=> toggle(confirmPass, toggleConfirm);

  function toggle(field, btn){
    field.type = field.type === "password" ? "text" : "password";
    btn.textContent = field.type === "text" ? "üôà" : "üëÅ";
  }

  // ‚úÖ REGISTER SUBMIT
  document.getElementById("register-form").addEventListener("submit", function(e){
    e.preventDefault();

    const name = fullname.value.trim();
    const email = email.value.trim().toLowerCase();
    const passVal = password.value;
    const confirm = confirmpassword.value;
    const terms = document.getElementById("terms").checked;

    if(!terms) return showToast("Accept Terms first");
    if(passVal.length < 8) return showToast("Password must be 8+ characters");
    if(passVal !== confirm) return showToast("Passwords do not match");

    const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
    if(users.find(u => u.email === email)){
      return showToast("Email already registered");
    }

    const user = {
      id: Date.now(),
      name,
      email,
      password: passVal,
      loggedIn: true
    };

    users.push(user);
    localStorage.setItem(USERS_KEY, JSON.stringify(users));
    localStorage.setItem(USER_KEY, JSON.stringify(user));

    showToast("Account created successfully!");
    setTimeout(()=>location.href="index.html", 1200);
  });

  function showToast(msg){
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.classList.add("show");
    setTimeout(()=>t.classList.remove("show"),2500);
  }
</script>

</body>
</html>
